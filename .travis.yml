language: java
jdk:
- oraclejdk11
before_install:
  - pip install --user awscli
  - export PATH=$PATH:$HOME/.local/bin
install: true
script: mvn clean install
before_deploy:
  - ./provision/upload_config.sh
  - ./provision/upload_image.sh
  - ./provision/upload_templates.sh
  - travis_wait 30 ./provision/deploy_stack.sh
deploy:
  provider: script
  script: bash ./provision/deploy_app.sh
  skip_cleanup: true
  on:
    branch: main
cache:
  directories:
  - "$HOME/.m2"
env:
  global:
  - APPLICATION_NAME: brewery
  - AWS_DEFAULT_REGION: us-east-1
  - CONFIGURATION_BUCKET: brewery-configuration
  - APPLICATION_ENVIRONMENT: brewery-dev
  - secure: nqoUqYv6elHREsp10U7qnh+wPa7fCOr/yMcaR9RE2eoSZJa+M3mLWlIOrYrmt0nNUPjGbeXPGee7cE13/gRASqZ3PuQ346ddvtERabkUzMH3v0drJrv8DKS1NmcEfO9QCaT8OZu4kPtlAl2MchjmCKYyS/53hm/m3t+cSzUrCKfnRVnIgQ/hX5TtLi97SGYZmhdnUL6OV2jPVRN3+gRmCgN7kgNdLaZnY21lLJlywPeIa2E094j5wzfaDybTW7OZ35M1NUchuG+MN+d71uDwebI/KqLeEeCUKDijFvFewl5Jhralky8MV+xfpXi1lvtWBLCgFXwT2OUSy/e+bC8SJkS2e1zMFYbyxlLa8kD8UGzjjj4r01bxT90JZDbYHZXZWFrXUdN3o6LxAqbFh37JW+fFVjQwkers/bq28X5YLu30zjch8jC/6/PDZOisVHyGEmLO3qzJZ1ZIfY/HoB4yIOoVjcqufRDPXf2ntAz+qoePSmT6WkSrKChnRX65mlA7BqT3SoLw8R5qiTxsXWIWRme2I+Xml5UH/GOEVXVmt+SclWpPSHjaFfnjg/8iVZ11TO6bPv6ENbj1oEV+eBOeR/ha+bcmkkffi8vSucb1xeT+7Obb0LDagssFO1U5qSz8Mutg0EguRSGKv6fc3hx7DhtOrTBMXU+4NHMLjFgqW48=
  - secure: FcFtFRNnwF3/zwqfjj40v7e/lkr/utRzzmud7uH3YEP89Y3SUN63wRAu7l9+OsVsL3AQ/E5qSHX5WY9YLE5i6/4gPM9iqpbSchpBF0Km71e63qVI2+FmEDeu0GeZkogt0HHapSSCcogfEkoht/wfNyyv1zp8HcEDVoSMl4NDnw/OsKyW/7W7o+tnRuWyjVSHwjA75Q9ZcsZq5gnn903XA4XRclbfvfZv3lbyF6J6aaNxyo0aqvH/c98FAbWWibE9NDNqXYDLKWw7yQVea82PSZVEU2EdLL87LTgL9b8Pcwr0g90ObeJD6CflGBy16WJCt+xwcXJ+pK5O8FjwAgV7zu7o8+B2SX4in9N2PUzrCAe9ETJfJb6Wg0FLsf42votZ5aOq2sVNrJ9HflFrP0+UHO0c6Z5Bg79sGC7NIGjQ/joIc6KRD6VET3RCO4nduqUlHUVgg2yuJpamL88kzlQ8PzxJBju3SkumKDxuRyrfIIZyEdjJ3dyZ8XFfJxqemqe4Wo4C+T0VswhUNg6aRAAeOG8+ab9vVO4cO6JQQ4ULprTHf8mYCq5Ou7GDbbn5ChlAc0zjIYTMHF7H8hqpm9FppJO64cez4FSJLl7pF/f5PMq8U/cTLL7RWgp6MQCdP8ycS0jH9zktcV+9+ODDRZox8y63VzF4CI/Dlwx9RlgEl+w=
  - secure: J0zHkc3db59fbyRWAgW0f+fBVmQx8EhEcBu2zRvi7LNjwG9Tt9icqdqiN7+3TiFWy4fCd6dQd0Te8APaKWCh/uHpA93ZZBEphFDwWKA1SrBLTJd0sIsOkKJ4fgKV2CYWmZ+bRhS/ZBPqJbBHL1oqawcmq4aoNGPeEyr2rEebAWfz+FVLoTUNSS/WI2Rk2Gf3//m98qdLNm3PuZTOgS4d9GffrTHvb2nFtUhgHer7qITn2gguCYcv9Qmo88Ifoqv/MRqt9pOJFM8NcYehWEpP00VTX9sqQoHCNMaLyNdM0VhcIJER/UuU2JmSGbnVu+T+Jnk09cnOVw/ZpURsfFXPaAIrFbPIjmY0OKi0YcoZhLgyPyZ8vdZRFhTDvlFuygsBXknF64++Q7XQs6K3VtksswYyQ4B1vke0fqQdgwUvmTmVk3eQ0nDSi8lCmlimU9YvcOWunIBtZSf4FM0Ic9k0p36V4ftDhsOwp1Rozh2ydDI/O/Yrczdqek+4Te626RKH0zUBbW8e8E3MljnytqmhSb6EtdKLhC6KpumxqBGzNOfauUw6D8gc8H4zF5rKY1lrUmWCCmoSz4Otq5gT7mqr2BxY0xz7BJVN9m/4lrwrsIvVqiRLqmVkcaWxwWjzLpk7iy2lXreu8S5tLwH0yq8BHo2R3uRIPjzWl8BgZqToliU=
  - AWS_DEFAULT_REGION: us-east-1
  - secure: zof2JYN64qdzVuF7i6J7QzoDXUZhpgg+p4Ezy67IlcTxex9+0otEDwL/Y5x2TIFnEZr3lW/iUqRP6xRs0btOFMaznUR87qYy/jep52yWnLu5QPI3fIw1VNLVVMHhxm0F5Ml6auxxNMvciQOyBXuKcGYNYPJlxRt3ImlM3Q4OZrP9n4/onKEssQgeM40NYK2s7t0XKoGQtxplivCLoLkFKPyaYFuCQQ+4RxrwaqMCY/0tI8OzK3A6os3Bs0huwD+vzowLhVeYwrTfo7laN9K32pdh1AdmNq0jWUATSAXHag8IR4ReRzU+aLC/XaMY7NLNs6yaZ7zFoq2t/tM2JnlLx0oKLoUIqnwJRRA8N7btbL2+mtYZGs57bTiXPmE+8iAg/+13CV4PjsySG3Oh30ZAs77uXQ86bitirsYMgkwQdORLkpjgQsJG0R20nGolKj7gLPsLUIjwBBOidU2ZHAew74aWfkPFrQs3jdSr/F2qLVXvEEJx/7Rwx33lmWcp2DxlkaFdfMRMVii5fLlV0egt7CbynOgEVezDcak1T4zX9n/eR2ny+hlGIcY47CPenAustZYVrLQOmwvrVnjwHnTdOTyDjJ3pJ6WYM6gL2V2emHydNZnC/tNiEWQqLKehC9qY9BvTienytafEEuj4tdpdf+x/81Al6PhmQOrNjlzq1DU=
  - secure: Fns0xjM1FQM7l+pMEdrs0lhnQdiDP0ua+zkxA5evvOrL6ohp7bf6XOnyLB89yy7Cxs96umawMbdhcuqIP31yf24+yy8c5zO7urncNCYgeyd1KvA43NDpUFcyN9IMxndUDHSi/isEDpAuveCZ9GpgMEXdyU8COh1bQU2C0BfOOYJK8hy0tUB5eM641zmYZ+4SHJrXhMAbnbL6pHWAtzvqEEigUmvURy+vK2lyFY1RWDdg7ioJlTx4YExJGNKsY9ox6opJqlnjgTwy7fczpS7e6T2c00BZqYJB5LhHzhd1PTUhK9qH98A5rLFJ7eppU+RgGB4uCCgBKHWmmIXeUns4FiAC8kVCLbUyxNR/G6ZjPABOT0Q+lOxpGj/720nc+Rzq81D1UxHqvptihtqiXEpYzCqBUoCumHrwx3dnDv5JGQ42/aElCyT8qxRxKpiC6203Jdh5qGoshoZQA+RawuZPtMvJndXCLX1iVL12Z+rEIHIbPEhfUuzjjlbUHpZ6Np5g5nIE+0xLYVEc9/BmFdXGTYYwiQCrhwaKqAWe6G6GfDU5eUVm84hMdmFG8ItYUfNyZNF/l3FDe5J8MjSB5WH5Ftczqh8S2Vvi5GD9n28yxbc/cRvNPcHtTr0WCb1bLEQ6mMj0/VM3w3CNFxzBZqn+lr0nmQ/rZL3hFzyFDpLWHz4=
  - secure: I1Zc6PCcZOu1X5G/CkQiTMDOJ2pU4UzwK4Inm/Y94OnYKMSrPR059xSsEF+uaQiBufPSY/Oyso1LHk7kYiRrYc8OloNeq6yqpLU3iEgP+wUYLvpRLF50PYCRHrk8Gw9HrIjjKcWkHOl10F0L1DH09ZivP6VruJ08okbTBCbFvelDqjUhnoFowdWanINIkwyVNwwRhg7aSEwlqd2tgY/H5r1toDmEiyh6FUIRdO6wYtsayku0fSth4L5pRJkRN8XerUCYZZcA+hcIETY6hspwiERRC8eFWcoZSyemV3Pg/08G5K7GmUeZiYAi8ASleVl4Jq1RpkLzsTrq82eW/PFCEfUO5eiLr6Y+sAHl02COsjVBeqvxARXFOV2hs4D6fSRp5JSV2KRn4m7oDf/UdtdeDmWS7CCka1zr5ZH/R3iklPI+WJSxaPlybIQH+ZWLFYZhRkBQ92jIHufjmkfUkCSwmiRWx2jTqCvhyDMIuZFLgDE097xoEkTvkrYqfIV1yWtXzjt0MRFrWV5N2A+J51Ox2OUOFr74KGdPcYeuczSS0/wOCyMtnqck8XZuYgWF0Zr2ECk2a1HxvW65r9ZfZb2c/X9jCJIPh51y/3PldPsFyfoVgxkLIHpkKsIslYTxjAU35gbi2wagVWGxu8irl5Ov4aza4A7R0t7F0MWoCSSASfc=
